{"mappings":"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","sources":["src/my-library.js","src/js/firebase-db-library.js","src/js/library-gallery.js"],"sourcesContent":["import './js/firebase-auth';\nimport './js/firebase-class';\nimport './js/firebase-db-index';\nimport './js/firebase-db-library';\n// import './js/firebase-movie-status-library';\nimport './js/change-color-scheme.js';\nimport './js/modal-team';\nimport './js/backToTop';\n","import { Firebase } from './firebase-class';\nimport { getRefs } from './get-refs';\nimport { renderLibrary } from './library-gallery';\nconst refs = getRefs();\n\nconst firebase = new Firebase();\n\nrefs.watched.addEventListener('click', showWatched);\nrefs.queue.addEventListener('click', showQueue);\n\nasync function showWatched() {\n  refs.queue.classList.remove('film-btn--active');\n  refs.watched.classList.add('film-btn--active');\n\n  let watched = await firebase.getDoc('watched');\n  if (watched.length === 0) {\n    //SPINNER\n    document.querySelector('.spinner').classList.add('hidden');\n    refs.filmGallery.innerHTML = '';\n    refs.filmGallery.insertAdjacentHTML(\n      'beforeend',\n      `<li class=\"film-list-error\">\n      <p class=\"library__text\">No watched movies found in the library</p>\n      <img src=\"https://nejdancs.github.io/filmoteka/cat__1.21cb105d.png\" alt=\"No watched movies found in the library\"/>\n    </li>`\n    );\n  } else {\n    refs.filmGallery.innerHTML = '';\n    renderLibrary(watched);\n    document.querySelector('.spinner').classList.add('hidden');\n  }\n}\n\nasync function showQueue() {\n  refs.watched.classList.remove('film-btn--active');\n  refs.queue.classList.add('film-btn--active');\n\n  // SPINNER\n  document.querySelector('.spinner').classList.add('hidden');\n\n  let queue = await firebase.getDoc('queue');\n\n  if (queue.length === 0) {\n    refs.filmGallery.innerHTML = '';\n    document.querySelector('.footer').classList.add('footer--empty-library');\n    refs.filmGallery.insertAdjacentHTML(\n      'beforeend',\n      `<li class=\"film-list-error\">\n        <p class=\"library__text\">No movies saved for viewing were found in the library</p>\n        <img src=\"https://nejdancs.github.io/filmoteka/cat__1.21cb105d.png\" alt=\"No movies saved for viewing were found in the library\"/>\n      </li>`\n    );\n  } else {\n    refs.filmGallery.innerHTML = '';\n    renderLibrary(queue);\n  }\n}\nconst qwe = setInterval(getUserStatus, 250);\n\nfunction getUserStatus(params) {\n  try {\n    refs.watched.classList.add('film-btn--active');\n    firebase.userStatus();\n    showWatched();\n    clearInterval(qwe);\n  } catch (error) {\n    // console.log('error');\n  }\n}\n","import { FilmsApiService } from './films-service';\nimport { getRefs } from './get-refs';\nimport { onMovieCardClick } from './movie-card';\n\nconst refs = getRefs();\nconst filmsApiService = new FilmsApiService();\n\nexport async function renderLibrary(filmsIds) {\n  const tmpl = (await Promise.all(filmsIds.map(renderMovieCardLib))).join('');\n  refs.filmGallery.insertAdjacentHTML('beforeend', tmpl);\n  document\n    .querySelectorAll('.film__item')\n    .forEach(node => node.addEventListener('click', onMovieCardClick));\n}\n\nasync function renderMovieCardLib(movieId) {\n  const movie = await filmsApiService.fetchMovie(movieId);\n  const markup = movieTplLib(movie);\n  return markup;\n}\n\nfunction movieTplLib(movie) {\n  const {\n    title,\n    name,\n    original_name,\n    original_title,\n    genres,\n    vote_average,\n    vote_count,\n    release_date,\n    poster_path: posterPath,\n    id,\n  } = movie;\n\n  const movieTitle = title ?? name ?? original_name ?? original_title ?? '';\n  const movieGenres = genres ? genres.slice(0, 2).map(genre => genre.name) : '';\n  if (genres && genres.length > 2) {\n    movieGenres.push('Other');\n  }\n  return ` <li class=\"film__item\" data-itemId=\"${id}\" data-imgpath=\"${posterPath}\">\n    \n        <a class=\"film__link\"\n        href=\"#\"\n        >\n     <img\n  id=\"${id}\"\n  data-imgpath=${posterPath}\n  class=\"film__image\"\n  ${\n    posterPath\n      ? `\n  srcset=\"\n  https://image.tmdb.org/t/p/w500/${posterPath}      500w,\n  https://image.tmdb.org/t/p/w780/${posterPath}      780w,\n  https://image.tmdb.org/t/p/w1280/${posterPath}    1280w,\n  https://image.tmdb.org/t/p/w300/${posterPath}      300w,\n    https://image.tmdb.org/t/p/original/${posterPath} 2000w\n  \"\n  src=\"https://image.tmdb.org/t/p/w300/${posterPath}\"\n  sizes=\"(min-width:1200px) 33vw, (min-width:768px) 50vw, 100vw\"\n\n  `\n      : `src=\"https://upload.wikimedia.org/wikipedia/commons/f/f9/No-image-available.jpg\"\n  `\n  }\n  alt=\"Movie: ${movieTitle}\"\n/>\n        </a>\n      </div>\n      <div class=\"film__info\">\n          <div class=\"aver-rate\">\n            <p class=\"film__info--text\"> Average rate ${vote_average.toFixed(\n              1\n            )} </p>\n          </div>\n          <div class=\"votes-amount\">\n            <p class=\"film__info--text\"> Votes ${vote_count}</p>\n          </div>\n        </div>\n      <div class=\"film__content\">\n        ${\n          movieTitle\n            ? `\n        <h3 class=\"film__film__title\">\n          ${movieTitle}</h3>\n        `\n            : ''\n        }\n      <div class=\"film__wrap\">\n      ${\n        movieGenres\n          ? `\n        <p class=\"film__genres\">${movieGenres.join(', ')}\n        </p>\n        `\n          : ''\n      } \n        \n        ${\n          release_date\n            ? `\n        <p class=\"film__date\">| ${new Date(release_date).getFullYear()}</p>\n        `\n            : ''\n        } \n        ${\n          vote_average\n            ? `\n        <p class=\"film__value\">${vote_average.toFixed(2)}</p>\n        `\n            : ''\n        }\n        </div>\n   </div>\n    </li>\n    `;\n}\nconst backdrop = document.querySelector('.backdrop');\nbackdrop.addEventListener('click', backdropClick);\n\nfunction renderMovieCard(movie, path) {\n  refs.insertImgCont.insertAdjacentHTML('beforeend', getPosterForCard(path));\n  refs.movieBox.insertAdjacentHTML('beforeend', movieCardTpl(movie));\n\n  document.querySelector('.spinner').classList.remove('hidden');\n}\nfunction movieCardTpl(movie) {\n  const {\n    title,\n    original_name,\n    original_title,\n    popularity,\n    genres,\n    vote_average,\n    vote_count,\n    overview,\n    id,\n  } = movie;\n\n  const movieTitle = original_name ?? original_title ?? '';\n  const movieGenres = genres ? genres.map(genre => genre.name) : '';\n\n  return `\n  <div class=\"movie__id\" id=\"${id}\" ><h2 class=\"movie-card__title\">\n    ${title ?? movieTitle}\n    </h2>\n  <div class=\"movie__info-container\">\n<table class=\"movie-info__table\">\n  <tr>\n    ${\n      vote_count\n        ? `\n            <td class=\"movie__info-item\">Vote / Votes</td>\n        `\n        : ''\n    }\n    ${\n      vote_count\n        ? `\n            <td class=\"movie__info-data\"><span class=\"td-box\">${vote_average.toFixed(\n              1\n            )}</span> / ${vote_count}</td>\n        `\n        : ''\n    }\n    \n  </tr>\n  <tr>\n    ${\n      popularity\n        ? `\n            <td class=\"movie__info-item\">Popularity</td>\n        `\n        : ''\n    }\n    ${\n      popularity\n        ? `\n            <td class=\"movie__info-data\">${popularity.toFixed(1)}</td>\n        `\n        : ''\n    }\n  </tr>\n  <tr>\n     ${\n       movieTitle\n         ? `\n                <td class=\"movie__info-item\">Original Title</td>\n        `\n         : ''\n     }\n    ${\n      movieTitle\n        ? `\n                <td class=\"movie__info-data movie__info-data--title\">${movieTitle}</td>\n        `\n        : ''\n    }\n  </tr>\n    <tr>\n    ${movieGenres ? `<td class=\"movie__info-item\">Genre</td>` : ''}\n    ${\n      movieGenres\n        ? `<td class=\"movie__info-data\">${movieGenres.join(', ')}</td>`\n        : ''\n    }\n  </tr>\n</table>\n</div>\n${\n  overview\n    ? `\n    <h3 class=\"movie__about\">About</h3> `\n    : ''\n}\n${\n  overview\n    ? `\n    <p class=\"movie__about-info\">${overview}</p> `\n    : ''\n}\n</div>`;\n}\n\nfunction getPosterForCard(path) {\n  return `\n<img\n  class=\"movie__poster\"\n  ${\n    path\n      ? `\n  srcset=\"\n    https://image.tmdb.org/t/p/w300/${path}      300w,\n    https://image.tmdb.org/t/p/w500/${path}      500w,\n    https://image.tmdb.org/t/p/w780/${path}      780w,\n    https://image.tmdb.org/t/p/w1280/${path}    1280w,\n    https://image.tmdb.org/t/p/original/${path} 2000w\n  \"\n  src=\"https://image.tmdb.org/t/p/w300/${path}\"\n  sizes=\"(min-width:1200px) 33vw, (min-width:768px) 50vw, 100vw\"\n\n  `\n      : `src=\"https://upload.wikimedia.org/wikipedia/commons/f/f9/No-image-available.jpg\"\n  `\n  }\n  alt=\"Movie title\"\n/>\n`;\n}\n\nrefs.modalCloseBtn.addEventListener('click', onMovieModalClose);\n\nfunction onMovieModalClose(e) {\n  refs.trailerOverlay.classList.remove('not-active');\n\n  refs.modalBackdrop.classList.add('is-hidden');\n  window.removeEventListener('keydown', onEscPress);\n  closeVideo();\n  document.querySelector('body').classList.remove('modal-open');\n  refs.insertVideoCont.innerHTML = ' ';\n\n  refs.addToWatched.textContent = 'add to watched';\n  refs.addToWatched.classList.remove('film-btn--active');\n  refs.addToQueue.textContent = 'add to queue';\n  refs.addToQueue.classList.remove('film-btn--active');\n  if (refs.queue.classList.contains('film-btn--active')) {\n    refs.queue.click();\n  } else {\n    refs.watched.click();\n  }\n}\n\nfunction onEscPress(e) {\n  if (e.code === 'Escape') {\n    onMovieModalClose();\n  }\n}\n\nfunction backdropClick(e) {\n  if (e.currentTarget === e.target) {\n    onMovieModalClose();\n  }\n}\n\nconst stopVideos = () => {\n  document.querySelectorAll('iframe').forEach(v => {\n    v.src = v.src;\n  });\n  document.querySelectorAll('video').forEach(v => {\n    v.pause();\n  });\n};\n\nrefs.trailerOverlay.addEventListener('click', showVideo);\nrefs.closeVideoBtn.addEventListener('click', closeVideo);\nrefs.watchBtn.addEventListener('click', showVideo);\n\nfunction videoTpl(trailer) {\n  const { key, site } = trailer;\n\n  return `<iframe class=\"iframe\" width=\"100%\" height=\"100%\" src=\"https://www.${site}.com/embed/${key}?origin=https://asyrotenko.github.io\" title=\"video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media;\n    gyroscope; picture-in-picture\" allowfullscreen></iframe>`;\n}\n\nfunction renderVideoBox(videos) {\n  const trailer = videos.find(video => video.name === 'Official Trailer' ?? {});\n  if (!trailer) {\n    refs.watchBtn.classList.add('not-active');\n    refs.trailerOverlay.classList.add('not-active');\n    return;\n  }\n  refs.insertVideoCont.insertAdjacentHTML('beforeend', videoTpl(trailer));\n}\n\nasync function showVideo() {\n  refs.insertVideoCont.classList.add('is-active');\n  refs.trailerBox.classList.add('is-active');\n  refs.watchBtn.setAttribute('disabled', ' ');\n  refs.closeVideoBtn.removeAttribute('disabled');\n  refs.insertVideoCont.scrollIntoView();\n}\n\nfunction closeVideo() {\n  stopVideos();\n  refs.insertVideoCont.classList.remove('is-active');\n  refs.trailerBox.classList.remove('is-active');\n  refs.closeVideoBtn.setAttribute('disabled', '');\n  refs.watchBtn.removeAttribute('disabled');\n}\n"],"names":["parcelRequire","$bpxeT","$b587c25746a4650e$var$refs","$3vKGz","getRefs","$b587c25746a4650e$var$filmsApiService","$8Mjv6","FilmsApiService","$b587c25746a4650e$export$e7d1a4959038c5e5","filmsIds","$b587c25746a4650e$var$_renderLibrary","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","tmpl","Promise","all","map","$b587c25746a4650e$var$renderMovieCardLib","_ctx","sent","join","filmGallery","insertAdjacentHTML","document","querySelectorAll","forEach","node","addEventListener","$94krt","onMovieCardClick","movieId","$b587c25746a4650e$var$_renderMovieCardLib","movie","markup","fetchMovie","$b587c25746a4650e$var$movieTplLib","ref","ref1","ref2","title","name","original_name","original_title","genres","vote_average","vote_count","release_date","posterPath","poster_path","id","movieTitle","movieGenres","slice","genre","length","push","concat","toFixed","Date","getFullYear","$b587c25746a4650e$var$onMovieModalClose","e","trailerOverlay","classList","remove","modalBackdrop","add","window","removeEventListener","$b587c25746a4650e$var$onEscPress","$b587c25746a4650e$var$closeVideo","querySelector","insertVideoCont","innerHTML","addToWatched","textContent","addToQueue","queue","contains","click","watched","code","currentTarget","target","modalCloseBtn","$b587c25746a4650e$var$showVideo","$b587c25746a4650e$var$_showVideo","trailerBox","watchBtn","setAttribute","closeVideoBtn","removeAttribute","scrollIntoView","v","src","pause","$b7e35614679cd5d5$var$refs","$b7e35614679cd5d5$var$firebase","$iGaYn","Firebase","$b7e35614679cd5d5$var$showWatched","$b7e35614679cd5d5$var$_showWatched","getDoc","$b7e35614679cd5d5$var$_showQueue","$b7e35614679cd5d5$var$qwe","setInterval","params","userStatus","clearInterval","error"],"version":3,"file":"my-library.d4fffac4.js.map"}